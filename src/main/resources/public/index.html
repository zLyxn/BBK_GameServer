<!DOCTYPE html>
        <html lang="en">
        <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>Dashboard</title>
          <style>
              :root {
                    --background-color: #f0f0f0;
                    --text-color: #333;
                    --text-background: #f9f9f9;
                    --console-border-color: #fff;
                    --btn-background-color: #8080ff;
                    --btn-hover-color: #3838ee;
                    --btn-text-color: #f0f0f0;
              }
              @media (prefers-color-scheme: dark) {
                  :root {
                      --background-color: #121212; /* Dark Mode Background */
                      --text-background: #242424;
                      --console-border-color: #3b3b3b; /* Dark Mode Console Border */
                      --text-color: #e0e0e0;        /* Dark Mode Text */
                      --btn-background-color: #3a3a80; /* Dark Mode Button Background */
                      --btn-hover-color: #5050a0;      /* Dark Mode Button Hover */
                      --btn-text-color: #f8f8f8;       /* Dark Mode Button Text */
                  }
              }
              body {
                  font-family: Bahnschrift, sans-serif;
                  text-align: center;
                  background-color: var(--background-color);
                  color: var(--text-color);
              }
              .ip{
                  font-family: Bahnschrift Condensed, sans-serif;
              }
              .status { font-weight: bold; }
              .online { color: green; }
              .offline { color: red; }
              #commandField { display: none; }
              .btn{
                  background-color: var(--btn-background-color);
                  border: none;
                  color: var(--btn-text-color);
                  padding: 10px 12px;
                  margin: 4px 2px;
                  text-align: center;
                  text-decoration: none;
                  display: inline-block;
                  font-size: 16px;
                  cursor: pointer;
                  border-radius: 100px;
                  width: 80%;
              }
              .btn:hover {
                  background-color: var(--btn-hover-color);
              }
              .btn:active{
                  transform: translateY(4px);
              }
              #commandInput{
                  padding: 10px 12px;
                  font-family: Bahnschrift, sans-serif;
                  box-sizing: border-box;
                  color: var(--text-color);
                  background-color: var(--text-background);
                  border: 1px solid var(--console-border-color);
                  width: 100%;
              }
              #commandInput::-webkit-input-placeholder {
                  font-family: Bahnschrift, sans-serif;
              }
              #commandInput:-ms-input-placeholder {
                  font-family: Bahnschrift, sans-serif;
              }
              #commandInput:-moz-placeholder {
                  font-family: Bahnschrift, sans-serif;
              }
              #consoleOutput{
                  line-height: 75%;
                  text-align: left;
                  width: 90%;
                  height: 60vh;
                  overflow-y: scroll;
                  border: 1px solid var(--console-border-color);
                  padding: 10px;
                  background-color: var(--text-background);
                  margin-bottom: 0;
                  box-sizing: border-box;
              }
              .container {
                  display: grid;
                  grid-template-columns: 1fr 3fr;
                  gap: 10px;
              }
              .commandInputContainer{
                  display: grid;
                  grid-template-columns: 20fr 1fr;
                  align-items: center;
                  justify-items: center;
                  width: 90%;
              }
              #submit {
                    background-color: var(--btn-background-color);
                    border: var(--btn-text-color);
                    color: white;
                    text-decoration: none;
                    font-size: 16px;
                    cursor: pointer;
                    height: 100%;
                    width: 100%;
                    text-align: center;
                    display: inline-grid;
                    justify-items: center;
                    align-items: center;
                }

              #submit:hover {
                  background-color: var(--btn-hover-color);
              }
              #submit:active {
                  transform: scaleX(1.25) translateX(10%);
              }
              #console{
                  margin-right: auto;
                  margin-left: auto;
              }
          </style>
          <script>
            if ('serviceWorker' in navigator) {
              window.addEventListener('load', () => {
                navigator.serviceWorker.register('/serviceWorker.js')
                  .then(registration => {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                  }, error => {
                    console.log('ServiceWorker registration failed: ', error);
                  });
              });
            }

            function updateGameServerStatus() {
              fetch('/status')
                .then(response => response.text())
                .then(status => {
                  const gameServerStatus = document.getElementById('gameServerStatus');
                  if (status.includes("true")) {
                    gameServerStatus.textContent = "Online";
                    gameServerStatus.className = "status online";
                    commandField.style.display = "block";
                  } else {
                    gameServerStatus.textContent = "Offline";
                    gameServerStatus.className = "status offline";
                    commandField.style.display = "none";
                  }
                })
                .catch(error => {
                  console.error("Error fetching status:", error);
                });
            }
            function updateConsoleOutput() {
              fetch('/logs')
                .then(response => response.text())
                .then(consoleOutput => {
                  const consoleDiv = document.getElementById('consoleOutput');
                  if (consoleDiv.innerHTML.replace(/\s/g, '') !== consoleOutput.replace(/<\/?html>|<\/?body>/g, '').replace(/\s/g, '')) {
                    consoleDiv.innerHTML = consoleOutput;
                    consoleDiv.scrollTop = consoleDiv.scrollHeight;
                  }
                })
                .catch(error => {
                        console.error("Error sending command:", error);
                    });

            }
            setInterval(updateConsoleOutput, 1000);
            setInterval(updateGameServerStatus, 5000);
            window.onload = updateGameServerStatus;
          </script>
        </head>
        <body>
          <h1>Welcome to the Dashboard!</h1>
          <div class="container">
              <div id="controlField">
                  <p>Game Server: <span id="gameServerStatus" class="status">Checking...</span></p>
                  <p>Web Server: <span id="webServerStatus" class="status">Checking...</span></p>
                  <p class="ip">IP Address: $$IP$$:$$GAMEPORT$$</p>
                  <hr>
                  <a href="/start" class="btn">Start the GameServer</a><br>
                  <a href="/stop" class="btn">Stop the GameServer</a><br>
                  <a href="/exit" class="btn">Stop the WebServer</a>
                  <a href="/threads" class="btn">Show all threads</a>
              </div>

              <div id="commandField">
                  <h2>Console:</h2>
                  <div id="console">
                      <pre id="consoleOutput">
                      </pre>
                      <div class="commandInputContainer">
                          <input type="text" id="commandInput" placeholder="Enter Command">
                          <!--<a id="submit" class="" href="#">&#x21a9;</a>-->
                          <a id="submit" class="" href="#">
                              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-send" viewBox="0 0 16 16">
                              <path d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576zm6.787-8.201L1.591 6.602l4.339 2.76z"></path>
                            </svg>
                          </a>
                      </div>
                  </div>

              </div>
          </div>

          <script>
              document.getElementById("commandInput").addEventListener("keypress", function(event) {
                  if (event.key === "Enter") {
                      event.preventDefault();
                      document.getElementById("submit").click();
                  }
              });
            document.getElementById("submit").addEventListener("click", updateLink);
            function updateLink(event) {
                event.preventDefault();
                const inputValue = document.getElementById('commandInput').value;
                const baseUrl = '/sendCommand';

                fetch(baseUrl + '?' + inputValue)
                    .then(response => {
                        if (response.ok) {
                            console.log("Command sent successfully");
                            document.getElementById('commandInput').value = ''; // Clear the input field
                        } else {
                            console.error("Error sending command:", response.statusText);
                        }
                    })
                    .catch(error => {
                        console.error("Error sending command:", error);
                    });
                updateConsoleOutput();
            }
          </script>
        </body>
        </html>